#!/bin/bash

#SBATCH --job-name=psipdb
#SBATCH --output=psipdb%a.out
#SBATCH --error=psipdb%a.err
#SBATCH --nodes=1
#SBATCH --ntasks=1
#SBATCH --cpus-per-task=1
#SBATCH --mem-per-cpu=1000MB
#SBATCH --time=8:00:00
#SBATCH --array=0-9
#SBATCH --qos=bryankol-b

module add python3
module load ncbi_blast

din=../data/pdbdata-strctinfo
dout=../data/pdbdata-evowts

farray1=(${din}/*.csv)
need_farray=()
for f1 in ${farray1[@]}; do
  fname=${f1##*/}
  if [ ! -f ${dout}/${fname} ]; then
    need_farray+=( ${din}/${fname} )
  fi
done

myfname=${need_farray[$SLURM_ARRAY_TASK_ID]}

echo "starting ${myfname}"

./evoPDBdata -f ${myfname} -o ${dout}

echo "DONE."
